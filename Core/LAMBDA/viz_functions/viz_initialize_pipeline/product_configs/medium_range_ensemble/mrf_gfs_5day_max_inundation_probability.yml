product: mrf_gfs_5day_max_inundation_probability
configuration: medium_range_ensemble
product_type: "fim"
domain: conus
run: true

ingest_files:
    - file_format: common/data/model/com/nwm/{{variable:NWM_DATAFLOW_VERSION}}/nwm.{{datetime:%Y%m%d}}/medium_range_mem2/nwm.t{{datetime:%H}}z.medium_range.channel_rt_2.f{{range:3,121,3,%03d}}.conus.nc
      file_step: None
      file_window: None
      target_table: ingest.nwm_channel_rt_mrf_gfs_mem2
      target_keys: (feature_id, streamflow)
    - file_format: common/data/model/com/nwm/{{variable:NWM_DATAFLOW_VERSION}}/nwm.{{datetime:%Y%m%d}}/medium_range_mem3/nwm.t{{datetime:%H}}z.medium_range.channel_rt_3.f{{range:3,121,3,%03d}}.conus.nc
      file_step: None
      file_window: None
      target_table: ingest.nwm_channel_rt_mrf_gfs_mem3
      target_keys: (feature_id, streamflow)
    - file_format: common/data/model/com/nwm/{{variable:NWM_DATAFLOW_VERSION}}/nwm.{{datetime:%Y%m%d}}/medium_range_mem4/nwm.t{{datetime:%H}}z.medium_range.channel_rt_4.f{{range:3,121,3,%03d}}.conus.nc
      file_step: None
      file_window: None
      target_table: ingest.nwm_channel_rt_mrf_gfs_mem4
      target_keys: (feature_id, streamflow)
    - file_format: common/data/model/com/nwm/{{variable:NWM_DATAFLOW_VERSION}}/nwm.{{datetime:%Y%m%d}}/medium_range_mem5/nwm.t{{datetime:%H}}z.medium_range.channel_rt_5.f{{range:3,121,3,%03d}}.conus.nc
      file_step: None
      file_window: None
      target_table: ingest.nwm_channel_rt_mrf_gfs_mem5
      target_keys: (feature_id, streamflow)
    - file_format: common/data/model/com/nwm/{{variable:NWM_DATAFLOW_VERSION}}/nwm.{{datetime:%Y%m%d}}/medium_range_mem6/nwm.t{{datetime:%H}}z.medium_range.channel_rt_6.f{{range:3,121,3,%03d}}.conus.nc
      file_step: None
      file_window: None
      target_table: ingest.nwm_channel_rt_mrf_gfs_mem6
      target_keys: (feature_id, streamflow)

db_max_flows:
  - name: mrf_gfs_mem2_5day_max_flows
    target_table: cache.max_flows_mrf_gfs_mem2_5day
    target_keys: (feature_id, streamflow)
    method: database
    max_flows_sql_file: mrf_gfs_mem2_5day_max_flows
  - name: mrf_gfs_mem3_5day_max_flows
    target_table: cache.max_flows_mrf_gfs_mem3_5day
    target_keys: (feature_id, streamflow)
    method: database
    max_flows_sql_file: mrf_gfs_mem3_5day_max_flows
  - name: mrf_gfs_mem4_5day_max_flows
    target_table: cache.max_flows_mrf_gfs_mem4_5day
    target_keys: (feature_id, streamflow)
    method: database
    max_flows_sql_file: mrf_gfs_mem4_5day_max_flows
  - name: mrf_gfs_mem5_5day_max_flows
    target_table: cache.max_flows_mrf_gfs_mem5_5day
    target_keys: (feature_id, streamflow)
    method: database
    max_flows_sql_file: mrf_gfs_mem5_5day_max_flows
  - name: mrf_gfs_mem6_5day_max_flows
    target_table: cache.max_flows_mrf_gfs_mem6_5day
    target_keys: (feature_id, streamflow)
    method: database
    max_flows_sql_file: mrf_gfs_mem6_5day_max_flows

fim_configs:
  - name: mrf_gfs_mem2_max_inundation_5day
    flows_table: cache.max_flows_mrf_gfs_mem2_5day
    target_table: ingest.mrf_gfs_mem2_max_inundation_5day
    fim_type: hand
    postprocess:
      sql_file: mrf_gfs_mem2_max_inundation_5day
      target_table: publish.mrf_gfs_mem2_max_inundation_5day
  - name: mrf_gfs_mem3_max_inundation_5day
    flows_table: cache.max_flows_mrf_gfs_mem3_5day
    target_table: ingest.mrf_gfs_mem3_max_inundation_5day
    fim_type: hand
    postprocess:
      sql_file: mrf_gfs_mem3_max_inundation_5day
      target_table: publish.mrf_gfs_mem3_max_inundation_5day
  - name: mrf_gfs_mem4_max_inundation_5day
    flows_table: cache.max_flows_mrf_gfs_mem4_5day
    target_table: ingest.mrf_gfs_mem4_max_inundation_5day
    fim_type: hand
    postprocess:
      sql_file: mrf_gfs_mem4_max_inundation_5day
      target_table: publish.mrf_gfs_mem4_max_inundation_5day
  - name: mrf_gfs_mem5_max_inundation_5day
    flows_table: cache.max_flows_mrf_gfs_mem5_5day
    target_table: ingest.mrf_gfs_mem5_max_inundation_5day
    fim_type: hand
    postprocess:
      sql_file: mrf_gfs_mem5_max_inundation_5day
      target_table: publish.mrf_gfs_mem5_max_inundation_5day
  - name: mrf_gfs_mem6_max_inundation_5day
    flows_table: cache.max_flows_mrf_gfs_mem6_5day
    target_table: ingest.mrf_gfs_mem6_max_inundation_5day
    fim_type: hand
    postprocess:
      sql_file: mrf_gfs_mem6_max_inundation_5day
      target_table: publish.mrf_gfs_mem6_max_inundation_5day